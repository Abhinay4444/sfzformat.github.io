<p>Note that modulations such as (on)ccN, and vel2* opcodes are included in the
pages describing the parameters they modulate.</p>

{%-for category in site.data.sfz.syntax.categories-%}
	{%-assign opcode_count = 0-%}
	{%-for opcode in category.opcodes-%}
		{%-if opcode.version == page.sfz_version-%}
			{%-assign opcode_count = opcode_count | plus: 1-%}
		{%-endif-%}
	{%-endfor-%}
{%-comment-%}<p>Debug: {{category.name}} has {{opcode_count}} items</p>{%-endcomment-%}
	{%-if opcode_count > 0-%}
		{%-if category.url != nil-%}
			{%-assign category_url = "<a href='" | append: category.url |
				append: "'>" | append: category.name  | append: "</a>"-%}
		{%else%}
			{%-assign category_url = category.name-%}
		{%-endif-%}
<h2>{{ category_url }}</h2>
<table class="table table-sm table-hover table-striped table-responsive">
	<thead class="thead-dark">
		<tr>
			<th scope="col">Opcode</th>
			<th scope="col">Description</th>
			<th scope="col">Type</th>
			<th scope="col">Default</th>
			<th scope="col">Range</th>
		</tr>
	</thead>
	<tbody>
		{%-for opcode in category.opcodes-%}
			{%-if opcode.version == page.sfz_version-%}
{%-comment-%} Opcode name and url link {%-endcomment-%}
				{%-if opcode.url == nil-%}
					{%-assign opcode_name = opcode.name | replace: '#', ''-%}
					{%-assign opcode_url = '<a href="/opcodes/' | append: opcode_name |
						append: '">' | append: opcode.name | append: '</a>'-%}
				{%-else-%}
					{%-assign opcode_url = '<a href="' | append opcode.url |
						append: '">' | append: opcode.name | append: '</a>'-%}
				{%-endif-%}
{%-comment-%} Opcode value range {%-endcomment-%}
				{%-if opcode.value.min == nil-%}
					{%-if opcode.value.options-%}
						{%-for option in opcode.value.options-%}
							{%-assign opcode_value_range = opcode_value_range | append: option.name-%}
								{%-if forloop.last == false-%}
									{%-assign opcode_value_range = opcode_value_range | append: ", "-%}
								{%-endif-%}
						{%-endfor-%}
					{%-else-%}
						{%-assign opcode_value_range = "N/A"-%}
					{%-endif-%}
				{%-else-%}
					{%-assign opcode_value_range = opcode.value.min | append: " to " |
						append: opcode.value.max | append: ' ' | append: opcode.value.unit-%}
				{%-endif-%}
{%-comment-%} Opcode default value {%-endcomment-%}
				{%-if opcode.value.default == nil-%}
					{%-assign opcode_value_default = "N/A"-%}
				{%-else-%}
					{%-assign opcode_value_default = opcode.value.default |
						append: ' ' | append: opcode.value.unit-%}
				{%-endif-%}
<tr>
			<td>{{ opcode_url }}</td>
			<td>{{ opcode.short_description }}</td>
			<td>{{ opcode.value.type_name }}</td>
			<td>{{ opcode_value_default }}</td>
			<td>{{ opcode_value_range }}</td>
		</tr>
			{%-endif-%}
	 {%-endfor-%}
	</tbody>
</table>
	{%-endif-%}
	{%-for category_type in category.types-%}
		{%-assign opcode_count = 0-%}
		{%-for opcode in category_type.opcodes-%}
			{%-if opcode.version == page.sfz_version-%}
				{%-assign opcode_count = opcode_count | plus: 1-%}
			{%-endif-%}
		{%-endfor-%}
{%-comment-%}<p>Debug: {{category.name}} has {{opcode_count}} items</p>{%-endcomment-%}
		{%-if opcode_count > 0-%}
			{%-if category.url != nil-%}
				{%-assign category_url = "<a href='" | append: category.url |
					append: "'>" | append: category.name  | append: "</a>"-%}
			{%else%}
				{%-assign category_url = category.name-%}
			{%-endif-%}
			{%-if category_type.url != nil-%}
				{%-assign category_type_url = "<a href='" | append: category_type.url |
					append: "'>" | append: category_type.name  | append: "</a>"-%}
			{%else%}
				{%-assign category_type_url = category_type.name-%}
			{%-endif-%}
<h2>{{ category_url }}: {{ category_type_url }}</h2>
<table class="table table-sm table-hover table-striped table-responsive">
	<thead class="thead-dark">
		<tr>
			<th scope="col">Opcode</th>
			<th scope="col">Description</th>
			<th scope="col">Type</th>
			<th scope="col">Default</th>
			<th scope="col">Range</th>
		</tr>
	</thead>
	<tbody>
			{%-for opcode in category_type.opcodes-%}
				{%-if opcode.version == page.sfz_version-%}
{%-comment-%} Opcode name and url link {%-endcomment-%}
					{%-if opcode.url == nil-%}
						{%-assign opcode_url = '<a href="/opcodes/' | append: opcode.name |
							append: '">' | append: opcode.name | append: '</a>'-%}
					{%-else-%}
						{%-assign opcode_url = '<a href="' | append opcode.url |
							append: '">' | append: opcode.name | append: '</a>'-%}
					{%-endif-%}
{%-comment-%} Opcode value range {%-endcomment-%}
					{%-assign opcode_value_range = ""-%}
					{%-if opcode.value.min == nil-%}
						{%-if opcode.value.options-%}
							{%-for option in opcode.value.options-%}
								{%-assign opcode_value_range = opcode_value_range | append: option.name-%}
									{%-if forloop.last == false-%}
										{%-assign opcode_value_range = opcode_value_range | append: ", "-%}
									{%-endif-%}
							{%-endfor-%}
						{%-else-%}
							{%-assign opcode_value_range = "N/A"-%}
						{%-endif-%}
					{%-else-%}
						{%-assign opcode_value_range = opcode.value.min | append: " to " |
							append: opcode.value.max | append: ' ' | append: opcode.value.unit-%}
					{%-endif-%}
{%-comment-%} Opcode default value {%-endcomment-%}
					{%-if opcode.value.default == nil-%}
						{%-assign opcode_value_default = "N/A"-%}
					{%-else-%}
						{%-assign opcode_value_default = opcode.value.default |
							append: ' ' | append: opcode.value.unit-%}
					{%-endif-%}
<tr>
			<td>{{ opcode_url }}</td>
			<td>{{ opcode.short_description }}</td>
			<td>{{ opcode.value.type_name }}</td>
			<td>{{ opcode_value_default }}</td>
			<td>{{ opcode_value_range }}</td>
		</tr>
				{%-endif-%}
			{%-endfor-%}
	</tbody>
</table>
		{%-endif-%}
	{%-endfor-%}
{%-endfor-%}
